import{HTMLOverlayContainer,ScriptLoader,error,Component}from"@hatiolab/things-scene";const NATURE={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"textarea",label:"option",name:"option",property:"option"},{type:"textarea",label:"series",name:"series",property:"series"}]},DEFAULT_OPTION={title:"NO OPTIONS"};class Echart extends HTMLOverlayContainer{dispose(){this._echart&&this._echart.dispose(),delete this._echart,delete this._anchor,super.dispose()}reposition(){super.reposition(),this._chart&&(this._chart.setOption(this.buildOptions(Object.assign({series:this.series},this.option))),this._chart.resize({width:"auto",height:"auto",silent:!0}))}oncreate_element(t){this._anchor=document.createElement("div"),this._anchor.style.width="100%",this._anchor.style.height="100%",this.element.appendChild(this._anchor),ScriptLoader.load(["http://echarts.baidu.com/dist/echarts.js"]).then(()=>{requestAnimationFrame(()=>{this._chart=echarts.init(this._anchor),this.reposition()})},error)}setElementProperties(t){}buildOptions(t){var{title:e={}}=t;return t.title=Object.assign(e,{text:this.text,show:!!this.text}),t}get series(){var{series:series,data:data}=this.state;if("object"!=typeof series)try{eval(`series = ${series}`)}catch(t){scene.error(t)}return series}get option(){var{option:option=DEFAULT_OPTION,data:data}=this.state;if("object"!=typeof option)try{eval(`option = ${option}`)}catch(t){scene.error(t)}return option}get tagName(){return"div"}get nature(){return NATURE}}Component.register("echart",Echart);export{Echart};
