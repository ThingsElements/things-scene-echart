!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@hatiolab/things-scene")):"function"==typeof define&&define.amd?define(["exports","@hatiolab/things-scene"],t):t((e=e||self)["things-scene-echart"]={},e.scene)}(this,function(exports,thingsScene){"use strict";const NATURE={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"textarea",label:"option",name:"option",property:"option"},{type:"textarea",label:"series",name:"series",property:"series"}]},DEFAULT_OPTION={title:"NO OPTIONS"};class Echart extends thingsScene.HTMLOverlayContainer{dispose(){this._echart&&this._echart.dispose(),delete this._echart,delete this._anchor,super.dispose()}reposition(){super.reposition(),this._chart&&(this._chart.setOption(this.buildOptions(Object.assign({series:this.series},this.option))),this._chart.resize({width:"auto",height:"auto",silent:!0}))}oncreate_element(e){this._anchor=document.createElement("div"),this._anchor.style.width="100%",this._anchor.style.height="100%",this.element.appendChild(this._anchor),thingsScene.ScriptLoader.load(["http://echarts.baidu.com/dist/echarts.js"]).then(()=>{requestAnimationFrame(()=>{this._chart=echarts.init(this._anchor),this.reposition()})},thingsScene.error)}setElementProperties(e){}buildOptions(e){var{title:t={}}=e;return e.title=Object.assign(t,{text:this.text,show:!!this.text}),e}get series(){var{series:series,data:data}=this.state;if("object"!=typeof series)try{eval(`series = ${series}`)}catch(e){scene.error(e)}return series}get option(){var{option:option=DEFAULT_OPTION,data:data}=this.state;if("object"!=typeof option)try{eval(`option = ${option}`)}catch(e){scene.error(e)}return option}get tagName(){return"div"}get nature(){return NATURE}}thingsScene.Component.register("echart",Echart),exports.Echart=Echart,Object.defineProperty(exports,"__esModule",{value:!0})});
